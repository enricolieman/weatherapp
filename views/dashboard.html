<!doctype html>
 <html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <title>Weather Us</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" type="image`/png" href="favicon.ico">

        <link href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,500,500i,700,700i" rel="stylesheet">


        <link rel="stylesheet" href="assets/css/swiper.min.css">
        <link rel="stylesheet" href="assets/css/animate.css">
        <link rel="stylesheet" href="assets/css/iconfont.css">
        <link rel="stylesheet" href="assets/css/font-awesome.min.css">
        <link rel="stylesheet" href="assets/css/bootstrap.min.css">
        <link rel="stylesheet" href="assets/css/magnific-popup.css">
        <link rel="stylesheet" href="assets/css/bootsnav.css">



        <link rel="stylesheet" href="assets/css/style.css">

        <link rel="stylesheet" href="assets/css/responsive.css" />

        <script src="assets/js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
        <script src="assets/js/vendor/jquery-1.11.2.min.js"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    </head>

    <body data-spy="scroll" data-tar`       `=".navbar-collapse">


        <div id="loading">
            <div id="loading-center">
                <div id="loading-center-absolute">
                    <div class="object" id="object_one"></div>
                    <div class="object" id="object_two"></div>
                    <div class="object" id="object_three"></div>
                    <div class="object" id="object_four"></div>
                </div>
            </div>
        </div>


        <div class="culmn">


            <nav class="navbar navbar-default bootsnav navbar-fixed white no-background">
                <div class="container">  

                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-menu">
                            <i class="fa fa-bars"></i>
                        </button>
                        <a class="navbar-brand" href="#brand">
                            <img src="assets/images/logo.png" class="logo logo-display" alt="">
                            <img src="assets/images/footer-logo.png" class="logo logo-scrolled" alt="">
                        </a>

                    </div>
                    <div class="collapse navbar-collapse" id="navbar-menu">
                        <ul class="nav navbar-nav navbar-center">
                            <li><a href="/">Home</a></li>
                            <li><a onclick="logout()">Logout</a></li>
                        </ul>
                    </div>
                </div>   
            </nav>

            <section id="home" class="home">
                <div class="container">
                    <div class="row">
                        <div class="main_home">
                            <div class="col-md-6 splash">
                                <div class="modal-dialog" role="document">
                                    <div class="modal-content">
                                      <div class="modal-header">
                                        <h5 class="modal-title">Weather Us</h5>
                                        </button>
                                      </div>
                                      <div class="modal-body">
                                        <input type="text" class="form-control" placeholder="Location" id="location">
                                      </div>
                                      <div class="modal-footer splash">
                                        <button type="button" class="btn btn-primary" onclick="getLocation()" >Get by my location</button>
                                      </div>
                                    </div>
                                  </div>
                            </div>
                        </div>

                        <table class="table text-black" style="background-color: white;" id="favorite">
                            <h1 class="text-white">Favorite Location</h1>
                          </table>
                    </div>
                </div>
            </section>

            <div class="loadings style-2"><div class="loadings-wheel"></div></div>
  
  <div class="modal fade" id="weather" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header text-center">
          <h5 class="modal-title" id="exampleModalLabel">Weather Us</h5>
          </button>
        </div>
        <div class="modal-body text-center">
          <img class="weatherIcon" id="weatherIcon" width="150px" height="150px">
          <h1 id="suhu"></h1>
          <h2 id="deskripsi"></h2>
          <h3><i class="fa fa-map-marker" id="lokasi"></i></h5>
        </div>
        <div class="modal-body text-center">
            <h5>Air Polution</h5>
            </div>
        <div class="modal-body text-left">
            <table class="table text-black" style="background-color: white;" id="air">
            </table>
        </div>
        <table class="table text-black" style="background-color: white;" id="ramalan">
        
        </table>
        <table class="table text-black" style="background-color: white;" id="history">
        
        </table>
        <div class="modal-footer">
            <input type="hidden" id="lat">
            <input type="hidden" id="long">
            <input type="hidden" id="kota">
            <input type="hidden" id="ikon">
            <button type="button" class="btn btn-primary" id="historyramalan">History</button>
          <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" onClick="tambahFavorit()">Add favorite</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="cuacafavorit" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header text-center">
          <h5 class="modal-title" id="exampleModalLabel">Weather Us</h5>
          </button>
        </div>
        <div class="modal-body text-center">
          <img class="weatherIcon" id="fweatherIcon" width="150px" height="150px">
          <h1 id="fsuhu"></h1>
          <h2 id="fdeskripsi"></h2>
          <h3><i class="fa fa-map-marker" id="flokasi"></i></h3>
        </div>
        <div class="modal-body text-center">
            <h5>Air Polution</h5>
            </div>
        <div class="modal-body text-left">
            <table class="table text-black" style="background-color: white;" id="fair">
            </table>
        </div>
        <table class="table text-black" style="background-color: white;" id="framalan">
        
        </table>

        <table class="table text-black" style="background-color: white;" id="fhistory">
        
        </table>
        <div class="modal-footer">
            <input type="hidden" id="fid">
            <button type="button" class="btn btn-primary" id="fhistoryramalan">History</button>
          <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" onClick="deleteFavorit()">Delete favorite</button>
        </div>
      </div>
    </div>
  </div>

        </div>
        <script>
        function tambahFavorit() {
    $("#weather").modal("hide");
    var t = $("#lat").val(),
        e = $("#long").val(),
        a = $("#kota").val(),
        o = $("#suhu").html(),
        i = $("#deskripsi").html(),
        n = $("#ikon").val();
    $.ajax({
        cache: !1,
        url: "/api/favorite/add",
        headers: {
            Authorization: localStorage.getItem("auth")
        },
        method: "PUT",
        data: {
            lat: t,
            long: e,
            kota: a
        },
        success: function(t) {
            0 == t.success && (localStorage.removeItem("auth"), window.location.href = "/"), $("#favorite").append('<tr id="row' + t.id + '" onclick="lihatfavorit(' + t.id + ')">\n                              <td>' + a + '</td>\n                              <td align="right">' + o + '</td>\n                              <td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + n + '.png"></span>' + i + "</td>\n                              \n</tr>"), $("#weather").modal("hide")
        }
    })
}

function logout() {
    localStorage.removeItem("auth"), window.location.href = "/"
}

function getLocation() {
    navigator.geolocation ? navigator.geolocation.getCurrentPosition(showPosition) : alert("Geolocation is not supported by this browser.")
}

function showPosition(t) {
    $("#loading").css("background-color", "transparent"), $("#loading").show(), $.ajax({
        url: "/api/weather",
        method: "POST",
        headers: {
            Authorization: localStorage.getItem("auth")
        },
        data: {
            lat: t.coords.latitude,
            long: t.coords.longitude
        }
    }).done(e => {
        var a = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
            o = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
        0 == e.success && (localStorage.removeItem("auth"), window.location.href = "/"), $("#loading").hide();
        var e = e.data;
        var i = parseFloat(e.main.temp - 273.15).toFixed(2);
        $("#suhu").html(i + "&deg;C"), $("#lat").val(t.coords.latitude), $("#long").val(t.coords.longitude), $("#kota").val(e.name), $("#lokasi").html(" " + e.name), $("#deskripsi").html(" " + e.weather[0].description), $("#ikon").val(e.weather[0].icon), $("#weatherIcon").attr("src", "https://openweathermap.org/img/wn/" + e.weather[0].icon + "@2x.png"), $("#weather").modal("show"), $.ajax({
            url: "/api/ramalan",
            method: "POST",
            headers: {
                Authorization: localStorage.getItem("auth")
            },
            data: {
                lat: t.coords.latitude,
                long: t.coords.longitude
            }
        }).done(t => {
            $.ajax({
            url: "/api/air",
            method: "POST",
            headers: {
                Authorization: localStorage.getItem("auth")
            },
            data: {
                lat: t.data.lat,
                long: t.data.lon
            }
        }).done(e => {
            var list = e.data.list[0].components;
            var co = list.co;
            var no = list.no;
            var no2 = list.no2;
            var o3 = list.o3;
            var so2 = list.so2;
            var pm2_5 = list.pm2_5;
            var pm10 = list.pm10;
            var nh3 = list.nh3;
            var air = "<tr><td>CO: "+co+" </td> <td>NO: "+no+" </td> <td>NO<sub>2</sub>: "+no2+" </td> <td>O<sub>3</sub>: "+o3+" </td> </tr><tr><td>SO<sub>2</sub>: "+so2+" </td> <td>PM2.5: "+pm2_5+" </td> <td>PM10: "+pm10+" </td> <td>NH<sub>3</sub>: "+nh3+"</td></tr><tr><td></td><td></td><td></td><td></td></tr>";
            $("#air").html(air);
        });
          var t = t.data;
            var e = new Date(1e3 * t.daily[0].dt),
                i = new Date(1e3 * t.daily[1].dt),
                n = new Date(1e3 * t.daily[2].dt),
                r = new Date(1e3 * t.daily[3].dt),
                d = new Date(1e3 * t.daily[4].dt),
                g = a[e.getDay({
                    timeZone: t.timezone
                })] + " " + o[e.getMonth({
                    timeZone: t.timezone
                })] + " " + e.getDate({
                    timeZone: t.timezone
                }),
                m = a[i.getDay({
                    timeZone: t.timezone
                })] + " " + o[i.getMonth({
                    timeZone: t.timezone
                })] + " " + i.getDate({
                    timeZone: t.timezone
                }),
                h = a[n.getDay({
                    timeZone: t.timezone
                })] + " " + o[n.getMonth({
                    timeZone: t.timezone
                })] + " " + n.getDate({
                    timeZone: t.timezone
                }),
                l = a[r.getDay({
                    timeZone: t.timezone
                })] + " " + o[r.getMonth({
                    timeZone: t.timezone
                })] + " " + r.getDate({
                    timeZone: t.timezone
                }),
                p = a[d.getDay({
                    timeZone: t.timezone
                })] + " " + o[d.getMonth({
                    timeZone: t.timezone
                })] + " " + d.getDate({
                    timeZone: t.timezone
                }),
                s = (t.daily[0].temp.day - 273.15).toFixed(2),
                c = (t.daily[1].temp.day - 273.15).toFixed(2),
                w = (t.daily[2].temp.day - 273.15).toFixed(2),
                y = (t.daily[3].temp.day - 273.15).toFixed(2),
                u = (t.daily[4].temp.day - 273.15).toFixed(2),
                x = t.daily[0].weather[0].description,
                z = t.daily[1].weather[0].description,
                D = t.daily[2].weather[0].description,
                Z = t.daily[3].weather[0].description,
                v = t.daily[4].weather[0].description,
                f = t.daily[0].weather[0].icon,
                I = t.daily[1].weather[0].icon,
                F = t.daily[2].weather[0].icon,
                S = t.daily[3].weather[0].icon,
                b = t.daily[4].weather[0].icon;
            $("#ramalan").html("");
            var M = "<tr><td>" + g + '</td><td align="right">' + s + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + f + '.png"></span>' + x + "</td></tr>";
            M += "<tr><td>" + m + '</td><td align="right">' + c + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + I + '.png"></span>' + z + "</td></tr>", M += "<tr><td>" + h + '</td><td align="right">' + w + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + F + '.png"></span>' + D + "</td></tr>", M += "<tr><td>" + l + '</td><td align="right">' + y + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + S + '.png"></span>' + Z + "</td></tr>", M += "<tr><td>" + p + '</td><td align="right">' + u + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + b + '.png"></span>' + v + "</td></tr>", $("#ramalan").append(M)
        }), $.ajax({
            url: "/api/history",
            method: "POST",
            headers: {
                Authorization: localStorage.getItem("auth")
            },
            data: {
                lat: t.coords.latitude,
                long: t.coords.longitude
            }
        }).done(e => {
            var i = new Date(1e3 * e[0].dt),
                n = new Date(1e3 * e[1].dt),
                r = new Date(1e3 * e[2].dt),
                d = new Date(1e3 * e[3].dt),
                g = new Date(1e3 * e[4].dt),
                m = a[i.getDay({
                    timeZone: t.timezone
                })] + " " + o[i.getMonth({
                    timeZone: t.timezone
                })] + " " + i.getDate({
                    timeZone: t.timezone
                }),
                h = a[n.getDay({
                    timeZone: t.timezone
                })] + " " + o[n.getMonth({
                    timeZone: t.timezone
                })] + " " + n.getDate({
                    timeZone: t.timezone
                }),
                l = a[r.getDay({
                    timeZone: t.timezone
                })] + " " + o[r.getMonth({
                    timeZone: t.timezone
                })] + " " + r.getDate({
                    timeZone: t.timezone
                }),
                p = a[d.getDay({
                    timeZone: t.timezone
                })] + " " + o[d.getMonth({
                    timeZone: t.timezone
                })] + " " + d.getDate({
                    timeZone: t.timezone
                }),
                s = a[g.getDay({
                    timeZone: t.timezone
                })] + " " + o[g.getMonth({
                    timeZone: t.timezone
                })] + " " + g.getDate({
                    timeZone: t.timezone
                }),
                c = (e[0].temp - 273.15).toFixed(2),
                w = (e[1].temp - 273.15).toFixed(2),
                y = (e[2].temp - 273.15).toFixed(2),
                u = (e[3].temp - 273.15).toFixed(2),
                x = (e[4].temp - 273.15).toFixed(2),
                z = e[0].weather[0].description,
                D = e[1].weather[0].description,
                Z = e[2].weather[0].description,
                v = e[3].weather[0].description,
                f = e[4].weather[0].description,
                I = e[0].weather[0].icon,
                F = e[1].weather[0].icon,
                S = e[2].weather[0].icon,
                b = e[3].weather[0].icon,
                M = e[4].weather[0].icon;
            $("#history").html("");
            var C = "<tr><td>" + m + '</td><td align="right">' + c + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + I + '.png"></span>' + z + "</td></tr>";
            C += "<tr><td>" + h + '</td><td align="right">' + w + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + F + '.png"></span>' + D + "</td></tr>", C += "<tr><td>" + l + '</td><td align="right">' + y + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + S + '.png"></span>' + Z + "</td></tr>", C += "<tr><td>" + p + '</td><td align="right">' + u + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + b + '.png"></span>' + v + "</td></tr>", C += "<tr><td>" + s + '</td><td align="right">' + x + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + M + '.png"></span>' + f + "</td></tr>", $("#history").append(C)
        }), $("#history").hide()
    })
}

function refreshFavorite() {
    $.ajax({
        url: "/api/favorite/all",
        method: "GET",
        headers: {
            Authorization: localStorage.getItem("auth")
        }
    }).done(t => {
        0 == t.success && (localStorage.removeItem("auth"), window.location.href = "/"), 0 !== t.data.length && t.data.forEach(t => {
            $.ajax({
                url: "/api/weather",
                method: "POST",
                headers: {
                    Authorization: localStorage.getItem("auth")
                },
                data: {
                    lat: t.lat,
                    long: t.long
                }
            }).then(e => {
                0 == e.success && (localStorage.removeItem("auth"), window.location.href = "/");
                var e = e.data;
                var a = parseFloat(e.main.temp - 273.15).toFixed(2);
                $("#favorite").append('<tr id="row' + t.id + '" onclick="lihatfavorit(' + t.id + ')">\n                              <td>' + t.kota + '</td>\n                              <td align="right">' + a + '&deg;C</td>\n                              <td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + e.weather[0].icon + '.png"></span>' + e.weather[0].description + "</td>\n                              \n</tr>")
            })
        })
    })
}

function lihatfavorit(t) {
    $("#loading").css("background-color", "transparent"), $("#loading").show(), $.ajax({
        url: "/api/weather",
        method: "POST",
        headers: {
            Authorization: localStorage.getItem("auth")
        },
        data: {
            id: t
        }
    }).done(e => {
        0 == e.success && (localStorage.removeItem("auth"), window.location.href = "/"), $("#loading").hide();
                var e = e.data;
        var a = parseFloat(e.main.temp - 273.15).toFixed(2);
        $("#fsuhu").html(a + "&deg;C"), $("#fkota").val(e.name), $("#flokasi").html(" " + e.name), $("#fid").val(t), $("#fdeskripsi").html(" " + e.weather[0].description), $("#fweatherIcon").attr("src", "https://openweathermap.org/img/wn/" + e.weather[0].icon + "@2x.png"), $("#cuacafavorit").modal("show");
        var o = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
            i = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
        $.ajax({
            url: "/api/ramalan",
            method: "POST",
            headers: {
                Authorization: localStorage.getItem("auth")
            },
            data: {
                id: t
            }
        }).done(t => {
          var t = t.data;
            var e = new Date(1e3 * t.daily[0].dt),
                a = new Date(1e3 * t.daily[1].dt),
                n = new Date(1e3 * t.daily[2].dt),
                r = new Date(1e3 * t.daily[3].dt),
                d = new Date(1e3 * t.daily[4].dt),
                g = o[e.getDay({
                    timeZone: t.timezone
                })] + " " + i[e.getMonth({
                    timeZone: t.timezone
                })] + " " + e.getDate({
                    timeZone: t.timezone
                }),
                m = o[a.getDay({
                    timeZone: t.timezone
                })] + " " + i[a.getMonth({
                    timeZone: t.timezone
                })] + " " + a.getDate({
                    timeZone: t.timezone
                }),
                h = o[n.getDay({
                    timeZone: t.timezone
                })] + " " + i[n.getMonth({
                    timeZone: t.timezone
                })] + " " + n.getDate({
                    timeZone: t.timezone
                }),
                l = o[r.getDay({
                    timeZone: t.timezone
                })] + " " + i[r.getMonth({
                    timeZone: t.timezone
                })] + " " + r.getDate({
                    timeZone: t.timezone
                }),
                p = o[d.getDay({
                    timeZone: t.timezone
                })] + " " + i[d.getMonth({
                    timeZone: t.timezone
                })] + " " + d.getDate({
                    timeZone: t.timezone
                }),
                s = (t.daily[0].temp.day - 273.15).toFixed(2),
                c = (t.daily[1].temp.day - 273.15).toFixed(2),
                w = (t.daily[2].temp.day - 273.15).toFixed(2),
                y = (t.daily[3].temp.day - 273.15).toFixed(2),
                u = (t.daily[4].temp.day - 273.15).toFixed(2),
                x = t.daily[0].weather[0].description,
                z = t.daily[1].weather[0].description,
                D = t.daily[2].weather[0].description,
                Z = t.daily[3].weather[0].description,
                v = t.daily[4].weather[0].description,
                f = t.daily[0].weather[0].icon,
                I = t.daily[1].weather[0].icon,
                F = t.daily[2].weather[0].icon,
                S = t.daily[3].weather[0].icon,
                b = t.daily[4].weather[0].icon;
            $("#framalan").html("");
            var M = "<tr><td>" + g + '</td><td align="right">' + s + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + f + '.png"></span>' + x + "</td></tr>";
            M += "<tr><td>" + m + '</td><td align="right">' + c + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + I + '.png"></span>' + z + "</td></tr>", M += "<tr><td>" + h + '</td><td align="right">' + w + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + F + '.png"></span>' + D + "</td></tr>", M += "<tr><td>" + l + '</td><td align="right">' + y + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + S + '.png"></span>' + Z + "</td></tr>", M += "<tr><td>" + p + '</td><td align="right">' + u + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + b + '.png"></span>' + v + "</td></tr>", $("#framalan").append(M)
        }), $.ajax({
            url: "/api/history",
            method: "POST",
            headers: {
                Authorization: localStorage.getItem("auth")
            },
            data: {
                id: t
            }
        }).done(e => {
            $.ajax({
            url: "/api/air",
            method: "POST",
            headers: {
                Authorization: localStorage.getItem("auth")
            },
            data: {
                id: t
            }
        }).done(e => {
            var list = e.data.list[0].components;
            var co = list.co;
            var no = list.no;
            var no2 = list.no2;
            var o3 = list.o3;
            var so2 = list.so2;
            var pm2_5 = list.pm2_5;
            var pm10 = list.pm10;
            var nh3 = list.nh3;
            var air = "<tr><td>CO: "+co+" </td> <td>NO: "+no+" </td> <td>NO<sub>2</sub>: "+no2+" </td> <td>O<sub>3</sub>: "+o3+" </td> </tr><tr><td>SO<sub>2</sub>: "+so2+" </td> <td>PM2.5: "+pm2_5+" </td> <td>PM10: "+pm10+" </td> <td>NH<sub>3</sub>: "+nh3+"</td></tr><tr><td></td><td></td><td></td><td></td></tr>";
            $("#fair").html(air);
        });
            var a = new Date(1e3 * e[0].dt),
                n = new Date(1e3 * e[1].dt),
                r = new Date(1e3 * e[2].dt),
                d = new Date(1e3 * e[3].dt),
                g = new Date(1e3 * e[4].dt),
                m = o[a.getDay({
                    timeZone: t.timezone
                })] + " " + i[a.getMonth({
                    timeZone: t.timezone
                })] + " " + a.getDate({
                    timeZone: t.timezone
                }),
                h = o[n.getDay({
                    timeZone: t.timezone
                })] + " " + i[n.getMonth({
                    timeZone: t.timezone
                })] + " " + n.getDate({
                    timeZone: t.timezone
                }),
                l = o[r.getDay({
                    timeZone: t.timezone
                })] + " " + i[r.getMonth({
                    timeZone: t.timezone
                })] + " " + r.getDate({
                    timeZone: t.timezone
                }),
                p = o[d.getDay({
                    timeZone: t.timezone
                })] + " " + i[d.getMonth({
                    timeZone: t.timezone
                })] + " " + d.getDate({
                    timeZone: t.timezone
                }),
                s = o[g.getDay({
                    timeZone: t.timezone
                })] + " " + i[g.getMonth({
                    timeZone: t.timezone
                })] + " " + g.getDate({
                    timeZone: t.timezone
                }),
                c = (e[0].temp - 273.15).toFixed(2),
                w = (e[1].temp - 273.15).toFixed(2),
                y = (e[2].temp - 273.15).toFixed(2),
                u = (e[3].temp - 273.15).toFixed(2),
                x = (e[4].temp - 273.15).toFixed(2),
                z = e[0].weather[0].description,
                D = e[1].weather[0].description,
                Z = e[2].weather[0].description,
                v = e[3].weather[0].description,
                f = e[4].weather[0].description,
                I = e[0].weather[0].icon,
                F = e[1].weather[0].icon,
                S = e[2].weather[0].icon,
                b = e[3].weather[0].icon,
                M = e[4].weather[0].icon;
            $("#fhistory").html("");
            var C = "<tr><td>" + m + '</td><td align="right">' + c + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + I + '.png"></span>' + z + "</td></tr>";
            C += "<tr><td>" + h + '</td><td align="right">' + w + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + F + '.png"></span>' + D + "</td></tr>", C += "<tr><td>" + l + '</td><td align="right">' + y + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + S + '.png"></span>' + Z + "</td></tr>", C += "<tr><td>" + p + '</td><td align="right">' + u + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + b + '.png"></span>' + v + "</td></tr>", C += "<tr><td>" + s + '</td><td align="right">' + x + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + M + '.png"></span>' + f + "</td></tr>", $("#fhistory").append(C)
        }), $("#fhistory").hide()
    })
}

function deleteFavorit() {
    $("#cuacafavorit").modal("hide");
    var t = $("#fid").val();
    $("#row" + t).remove(), $.ajax({
        cache: !1,
        url: "/api/favorite/" + t,
        headers: {
            Authorization: localStorage.getItem("auth")
        },
        method: "DELETE",
        success: function(t) {
            0 == t.success && (localStorage.removeItem("auth"), window.location.href = "/")
        }
    })
}
$(document).ready(function() {
    $("#historyramalan").on("click", function() {
        "History" == $("#historyramalan").html() ? ($("#historyramalan").html("Forecast"), $("#ramalan").hide(), $("#history").show()) : ($("#historyramalan").html("History"), $("#ramalan").show(), $("#history").hide())
    }), $("#fhistoryramalan").on("click", function() {
        "History" == $("#fhistoryramalan").html() ? ($("#fhistoryramalan").html("Forecast"), $("#framalan").hide(), $("#fhistory").show()) : ($("#fhistoryramalan").html("History"), $("#framalan").show(), $("#fhistory").hide())
    }), refreshFavorite(), $("#location").autocomplete({
        source: function(t, e) {
            $.ajax({
                cache: !1,
                url: "/api/city/" + t.term,
                headers: {
                    Authorization: localStorage.getItem("auth")
                },
                success: function(t) {
                    0 == t.success && (localStorage.removeItem("auth"), window.location.href = "/"), e($.map(t.predictions, function(t) {
                        return {
                            label: t.description,
                            id: t.place_id
                        }
                    }))
                }
            })
        },
        select: function(t, e) {
            $("#loading").css("background-color", "transparent"), $("#loading").show(), $.ajax({
                cache: !1,
                url: "/api/geo/" + e.item.id,
                headers: {
                    Authorization: localStorage.getItem("auth")
                },
                success: function(t) {
                    var e = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
                        a = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
                    0 == t.success && (localStorage.removeItem("auth"), window.location.href = "/");
                    var o = t.result.geometry.location.lat,
                        i = t.result.geometry.location.lng;
                    $.ajax({
                        url: "/api/weather",
                        method: "POST",
                        headers: {
                            Authorization: localStorage.getItem("auth")
                        },
                        data: {
                            lat: o,
                            long: i
                        }
                    }).done(t => {
                        0 == t.success && (localStorage.removeItem("auth"), window.location.href = "/"), $("#loading").hide();
                        var t = t.data;
                        var n = parseFloat(t.main.temp - 273.15).toFixed(2);
                        $("#suhu").html(n + "&deg;C"), $("#lat").val(o), $("#long").val(i), $("#kota").val(t.name), $("#lokasi").html(" " + t.name), $("#deskripsi").html(" " + t.weather[0].description), $("#ikon").val(t.weather[0].icon), $("#weatherIcon").attr("src", "https://openweathermap.org/img/wn/" + t.weather[0].icon + "@2x.png"), $("#weather").modal("show"), $("#location").val(""), $.ajax({
                            url: "/api/ramalan",
                            method: "POST",
                            headers: {
                                Authorization: localStorage.getItem("auth")
                            },
                            data: {
                                lat: o,
                                long: i
                            }
                        }).done(t => {
                            $.ajax({
            url: "/api/air",
            method: "POST",
            headers: {
                Authorization: localStorage.getItem("auth")
            },
            data: {
                lat: t.data.lat,
                long: t.data.lon
            }
        }).done(e => {
            var list = e.data.list[0].components;
            var co = list.co;
            var no = list.no;
            var no2 = list.no2;
            var o3 = list.o3;
            var so2 = list.so2;
            var pm2_5 = list.pm2_5;
            var pm10 = list.pm10;
            var nh3 = list.nh3;
            var air = "<tr><td>CO: "+co+" </td> <td>NO: "+no+" </td> <td>NO<sub>2</sub>: "+no2+" </td> <td>O<sub>3</sub>: "+o3+" </td> </tr><tr><td>SO<sub>2</sub>: "+so2+" </td> <td>PM2.5: "+pm2_5+" </td> <td>PM10: "+pm10+" </td> <td>NH<sub>3</sub>: "+nh3+"</td></tr><tr><td></td><td></td><td></td><td></td></tr>";
            $("#air").html(air);
        });
                          var t = t.data;
                            var o = new Date(1e3 * t.daily[0].dt),
                                i = new Date(1e3 * t.daily[1].dt),
                                n = new Date(1e3 * t.daily[2].dt),
                                r = new Date(1e3 * t.daily[3].dt),
                                d = new Date(1e3 * t.daily[4].dt),
                                g = e[o.getDay({
                                    timeZone: t.timezone
                                })] + " " + a[o.getMonth({
                                    timeZone: t.timezone
                                })] + " " + o.getDate({
                                    timeZone: t.timezone
                                }),
                                m = e[i.getDay({
                                    timeZone: t.timezone
                                })] + " " + a[i.getMonth({
                                    timeZone: t.timezone
                                })] + " " + i.getDate({
                                    timeZone: t.timezone
                                }),
                                h = e[n.getDay({
                                    timeZone: t.timezone
                                })] + " " + a[n.getMonth({
                                    timeZone: t.timezone
                                })] + " " + n.getDate({
                                    timeZone: t.timezone
                                }),
                                l = e[r.getDay({
                                    timeZone: t.timezone
                                })] + " " + a[r.getMonth({
                                    timeZone: t.timezone
                                })] + " " + r.getDate({
                                    timeZone: t.timezone
                                }),
                                p = e[d.getDay({
                                    timeZone: t.timezone
                                })] + " " + a[d.getMonth({
                                    timeZone: t.timezone
                                })] + " " + d.getDate({
                                    timeZone: t.timezone
                                }),
                                s = (t.daily[0].temp.day - 273.15).toFixed(2),
                                c = (t.daily[1].temp.day - 273.15).toFixed(2),
                                w = (t.daily[2].temp.day - 273.15).toFixed(2),
                                y = (t.daily[3].temp.day - 273.15).toFixed(2),
                                u = (t.daily[4].temp.day - 273.15).toFixed(2),
                                x = t.daily[0].weather[0].description,
                                z = t.daily[1].weather[0].description,
                                D = t.daily[2].weather[0].description,
                                Z = t.daily[3].weather[0].description,
                                v = t.daily[4].weather[0].description,
                                f = t.daily[0].weather[0].icon,
                                I = t.daily[1].weather[0].icon,
                                F = t.daily[2].weather[0].icon,
                                S = t.daily[3].weather[0].icon,
                                b = t.daily[4].weather[0].icon;
                            $("#ramalan").html("");
                            var M = "<tr><td>" + g + '</td><td align="right">' + s + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + f + '.png"></span>' + x + "</td></tr>";
                            M += "<tr><td>" + m + '</td><td align="right">' + c + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + I + '.png"></span>' + z + "</td></tr>", M += "<tr><td>" + h + '</td><td align="right">' + w + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + F + '.png"></span>' + D + "</td></tr>", M += "<tr><td>" + l + '</td><td align="right">' + y + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + S + '.png"></span>' + Z + "</td></tr>", M += "<tr><td>" + p + '</td><td align="right">' + u + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + b + '.png"></span>' + v + "</td></tr>", $("#ramalan").append(M)
                        }), $.ajax({
                            url: "/api/history",
                            method: "POST",
                            headers: {
                                Authorization: localStorage.getItem("auth")
                            },
                            data: {
                                lat: o,
                                long: i
                            }
                        }).done(o => {
                            var i = new Date(1e3 * o[0].dt),
                                n = new Date(1e3 * o[1].dt),
                                r = new Date(1e3 * o[2].dt),
                                d = new Date(1e3 * o[3].dt),
                                g = new Date(1e3 * o[4].dt),
                                m = e[i.getDay({
                                    timeZone: t.timezone
                                })] + " " + a[i.getMonth({
                                    timeZone: t.timezone
                                })] + " " + i.getDate({
                                    timeZone: t.timezone
                                }),
                                h = e[n.getDay({
                                    timeZone: t.timezone
                                })] + " " + a[n.getMonth({
                                    timeZone: t.timezone
                                })] + " " + n.getDate({
                                    timeZone: t.timezone
                                }),
                                l = e[r.getDay({
                                    timeZone: t.timezone
                                })] + " " + a[r.getMonth({
                                    timeZone: t.timezone
                                })] + " " + r.getDate({
                                    timeZone: t.timezone
                                }),
                                p = e[d.getDay({
                                    timeZone: t.timezone
                                })] + " " + a[d.getMonth({
                                    timeZone: t.timezone
                                })] + " " + d.getDate({
                                    timeZone: t.timezone
                                }),
                                s = e[g.getDay({
                                    timeZone: t.timezone
                                })] + " " + a[g.getMonth({
                                    timeZone: t.timezone
                                })] + " " + g.getDate({
                                    timeZone: t.timezone
                                }),
                                c = (o[0].temp - 273.15).toFixed(2),
                                w = (o[1].temp - 273.15).toFixed(2),
                                y = (o[2].temp - 273.15).toFixed(2),
                                u = (o[3].temp - 273.15).toFixed(2),
                                x = (o[4].temp - 273.15).toFixed(2),
                                z = o[0].weather[0].description,
                                D = o[1].weather[0].description,
                                Z = o[2].weather[0].description,
                                v = o[3].weather[0].description,
                                f = o[4].weather[0].description,
                                I = o[0].weather[0].icon,
                                F = o[1].weather[0].icon,
                                S = o[2].weather[0].icon,
                                b = o[3].weather[0].icon,
                                M = o[4].weather[0].icon;
                            $("#history").html("");
                            var C = "<tr><td>" + m + '</td><td align="right">' + c + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + I + '.png"></span>' + z + "</td></tr>";
                            C += "<tr><td>" + h + '</td><td align="right">' + w + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + F + '.png"></span>' + D + "</td></tr>", C += "<tr><td>" + l + '</td><td align="right">' + y + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + S + '.png"></span>' + Z + "</td></tr>", C += "<tr><td>" + p + '</td><td align="right">' + u + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + b + '.png"></span>' + v + "</td></tr>", C += "<tr><td>" + s + '</td><td align="right">' + x + '&deg;C</td><td align="right"><img class="weatherIcon" style="margin-top: -20px; margin-bottom: -20px;" src="https://openweathermap.org/img/wn/' + M + '.png"></span>' + f + "</td></tr>", $("#history").append(C)
                        }), $("#history").hide()
                    })
                }
            })
        }
    })
});
            </script>

        <script src="assets/js/vendor/bootstrap.min.js"></script>

        <script src="assets/js/jquery.magnific-popup.js"></script>
        <script src="assets/js/jquery.easing.1.3.js"></script>
        <script src="assets/js/swiper.min.js"></script>
        <script src="assets/js/jquery.collapse.js"></script>
        <script src="assets/js/bootsnav.js"></script>



        <script src="assets/js/plugins.js"></script>
        <script src="assets/js/dashboard.js"></script>

    </body>
</html>
